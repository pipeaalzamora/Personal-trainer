"use strict";(()=>{var e={};e.id=278,e.ids=[278],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},86203:(e,r,s)=>{s.r(r),s.d(r,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>x,routeModule:()=>l,serverHooks:()=>q,staticGenerationAsyncStorage:()=>m});var t={};s.r(t),s.d(t,{GET:()=>d});var o=s(49303),a=s(88716),n=s(60670),i=s(87070),u=s(71615),c=s(65634),p=s(85662);async function d(e){try{let{searchParams:r}=new URL(e.url),s=r.get("courseId");if(!s)return i.NextResponse.json({error:"El par\xe1metro courseId es requerido"},{status:400});let t=(0,u.cookies)(),o=t.get("user_email")?.value;if(!o)return i.NextResponse.json({error:"Usuario no autenticado"},{status:401});let a=await (0,c.CX)(o);if(!a)return i.NextResponse.json({error:"Usuario no encontrado"},{status:404});let{data:n,error:d}=await p.OQ.from("order_items").select(`
        id,
        order:orders!inner(
          id,
          user_id,
          status
        )
      `).eq("course_id",s).eq("order.user_id",a.id).eq("order.status","COMPLETED");if(d)throw Error(`Error al verificar acceso: ${d.message}`);if(!n||0===n.length)return i.NextResponse.json({error:"No has comprado este curso"},{status:403});return i.NextResponse.json({success:!0,message:"Tienes acceso a este curso"})}catch(e){return console.error("Error verificando acceso:",e),i.NextResponse.json({error:e instanceof Error?e.message:"Error al verificar acceso"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/my-courses/access/route",pathname:"/api/my-courses/access",filename:"route",bundlePath:"app/api/my-courses/access/route"},resolvedPagePath:"/home/pipeaalzamora/Documentos/Personal-trainer/app/api/my-courses/access/route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:x,staticGenerationAsyncStorage:m,serverHooks:q}=l,f="/api/my-courses/access/route";function g(){return(0,n.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:m})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[948,972,518,35],()=>s(86203));module.exports=t})();