(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[364],{7010:function(e,t,r){Promise.resolve().then(r.bind(r,3306))},3306:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7437),s=r(2265),a=r(9376),o=r(6070),i=r(2869),c=r(5153),d=r(401);let l=(0,r(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function u(){var e;let t=(0,a.useSearchParams)(),r=(0,a.useRouter)(),{toast:u}=(0,c.pm)(),[f,m]=(0,s.useState)("loading"),[p,h]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=t.get("token_ws")||localStorage.getItem("transbank_token");if(!e){m("error"),u({title:"Error en la transacci\xf3n",description:"No se encontr\xf3 informaci\xf3n de la transacci\xf3n",variant:"destructive"});return}(async()=>{try{let t=await fetch("/api/transbank/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),r=await t.json();t.ok&&"AUTHORIZED"===r.status?(m("success"),h(r),localStorage.removeItem("cart"),localStorage.removeItem("transbank_token"),u({title:"\xa1Pago exitoso!",description:"Tu compra ha sido procesada correctamente"})):(m("error"),h(r),u({title:"Error en el pago",description:r.error||"Hubo un problema con tu pago",variant:"destructive"}))}catch(e){console.error("Error al procesar la transacci\xf3n:",e),m("error"),u({title:"Error inesperado",description:"Ocurri\xf3 un error al procesar la transacci\xf3n",variant:"destructive"})}})()},[t,u]),(0,n.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,n.jsxs)(o.Zb,{className:"max-w-2xl mx-auto",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsx)(o.ll,{className:"text-2xl font-bold",children:"Estado del Pago"})}),(0,n.jsxs)(o.aY,{children:["loading"===f&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),(0,n.jsx)("p",{className:"mt-4 text-center",children:"Procesando tu pago..."})]}),"success"===f&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,n.jsx)("div",{className:"rounded-full bg-green-100 p-3",children:(0,n.jsx)(d.Z,{className:"h-12 w-12 text-green-600"})}),(0,n.jsx)("h3",{className:"mt-4 text-xl font-medium text-green-600",children:"\xa1Pago exitoso!"}),(0,n.jsx)("p",{className:"mt-2 text-center",children:"Tu compra ha sido procesada correctamente"}),p&&(0,n.jsxs)("div",{className:"mt-6 w-full border rounded-lg p-4 bg-gray-50",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Orden:"})," ",p.buy_order]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Autorizaci\xf3n:"})," ",p.authorization_code]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Monto:"})," $",p.amount]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Tarjeta:"})," **** **** **** ",null===(e=p.card_detail)||void 0===e?void 0:e.card_number]})]})]}),"error"===f&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,n.jsx)("div",{className:"rounded-full bg-red-100 p-3",children:(0,n.jsx)(l,{className:"h-12 w-12 text-red-600"})}),(0,n.jsx)("h3",{className:"mt-4 text-xl font-medium text-red-600",children:"Error en el pago"}),(0,n.jsx)("p",{className:"mt-2 text-center",children:"Hubo un problema al procesar tu pago"}),p&&p.error&&(0,n.jsx)("div",{className:"mt-6 w-full border rounded-lg p-4 bg-gray-50",children:(0,n.jsx)("p",{className:"text-red-600",children:p.error})})]})]}),(0,n.jsx)(o.eW,{className:"flex justify-center",children:(0,n.jsx)(i.z,{onClick:()=>r.push("/"),children:"Volver al inicio"})})]})})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var n=r(7437),s=r(2265),a=r(5293),o=r(535),i=r(4508);let c=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:d=!1,...l}=e,u=d?a.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(c({variant:s,size:o,className:r})),ref:t,...l})});d.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return o},aY:function(){return l},eW:function(){return u},ll:function(){return c}});var n=r(7437),s=r(2265),a=r(4508);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});l.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},5153:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var n=r(2265);let s=0,a=new Map,o=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],d={toasts:[]};function l(e){d=i(d,e),c.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>l({type:"DISMISS_TOAST",toastId:r});return l({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(d);return n.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(1994),s=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:d="",children:l,iconNode:u,...f}=e;return(0,n.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:r,strokeWidth:c?24*Number(i)/Number(s):i,className:a("lucide",d),...f},[...u.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(l)?l:[l]])}),c=(e,t)=>{let r=(0,n.forwardRef)((r,o)=>{let{className:c,...d}=r;return(0,n.createElement)(i,{ref:o,iconNode:t,className:a("lucide-".concat(s(e)),c),...d})});return r.displayName="".concat(e),r}},401:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"notFound")&&r.d(t,{notFound:function(){return n.notFound}}),r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[50,971,117,744],function(){return e(e.s=7010)}),_N_E=e.O()}]);